## column-context-menu - COMPLETED
Add right-click context menu on column headers with Insert/Delete options

### Key decisions
- Created ColumnHeaderContextMenu component with fixed positioning at mouse coordinates
- Menu options: "Insert column before", "Insert column after", "Delete column"
- Delete option hidden for SKU column (type='sku') since it cannot be deleted
- Created DeleteColumnConfirmDialog for confirming column deletion with data loss warning
- Spec columns show enhanced warning about specification column data loss
- Context menu detects header row (row 0 in tbody) and column index from DOM traversal
- Insert before/after opens AddColumnDialog with defaultPosition prop pre-set
- Delete confirmation updates both columns array and removes column data from all rows atomically

### Files changed
- src/components/spreadsheet/ColumnHeaderContextMenu.tsx (new, ~135 lines)
- src/components/spreadsheet/ColumnHeaderContextMenu.test.tsx (new, 15 tests)
- src/components/DeleteColumnConfirmDialog.tsx (new, ~60 lines)
- src/components/DeleteColumnConfirmDialog.test.tsx (new, 10 tests)
- src/components/SpreadsheetContainer.tsx (added context menu state, handlers, and rendering)
- src/components/SpreadsheetContainer.test.tsx (added 10 tests for context menu integration)

### Notes
- All 7 stepsToVerify criteria verified via unit tests
- Tests cover: menu rendering, options display, SKU column protection, dialog integration, column deletion
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (679 tests, +35 new)
- npm run build passes

## add-column-dialog - COMPLETED
Create AddColumnDialog component for inserting columns at any position

### Key decisions
- Created AddColumnDialog component with column type toggle (Specification/Free)
- Spec type shows dropdown of existing specs + "Create new" option with inline spec form
- Free type shows text input for column name
- Position selector shows "At end" or "Before [ColumnName]" for all non-SKU columns
- Component uses native `<select>` styled to match shadcn/ui for simplicity
- New spec creation uses sheet-scoped addSpecification/addSpecValue from useSheetsStore
- Column insertion updates both columns array and data rows atomically via setState
- defaultPosition prop allows pre-selecting position (for future context menu integration)

### Files changed
- src/components/AddColumnDialog.tsx (new, ~320 lines)
- src/components/AddColumnDialog.test.tsx (new, 46 tests)

### Notes
- All 6 stepsToVerify criteria verified via unit tests
- Tests cover: rendering, type toggle, spec selector, new spec form, position selection, validation, submit logic
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (644 tests, +46 new)
- npm run build passes

## spec-store-migration - COMPLETED
Migrate specification management methods from global useSpecificationsStore to sheet-scoped methods in useSheetsStore

### Key decisions
- Added 9 sheet-scoped methods to useSheetsStore interface:
  - addSpecification(sheetId, name) -> returns specId or null
  - updateSpecification(sheetId, specId, updates) -> returns boolean
  - removeSpecification(sheetId, specId) -> returns boolean (recalculates order)
  - reorderSpec(sheetId, specId, newOrder) -> returns boolean
  - addSpecValue(sheetId, specId, displayValue, skuFragment) -> returns valueId or null
  - updateSpecValue(sheetId, specId, valueId, updates) -> returns boolean
  - removeSpecValue(sheetId, specId, valueId) -> returns boolean
  - getSpecificationById(sheetId, specId) -> returns Specification or undefined
  - validateSkuFragment(sheetId, specId, skuFragment, excludeValueId?) -> returns boolean
- Updated SpecificationList to use sheet-scoped methods (reorderSpec, updateSpecValue, validateSkuFragment)
- Updated AddSpecDialog to use sheet-scoped methods (addSpecification, addSpecValue)
- SpecValueItem now receives sheetId prop for calling sheet-scoped methods
- Removed useSpecificationsStore import from SpecificationList and AddSpecDialog

### Files changed
- src/store/sheets.ts (added interface methods + implementations, ~180 lines)
- src/components/SpecificationList.tsx (updated to use sheet-scoped methods, pass sheetId)
- src/components/AddSpecDialog.tsx (updated to use sheet-scoped methods)
- src/store/sheets.test.ts (added 24 tests for sheet-scoped methods)
- src/components/SpecificationList.test.tsx (updated to check sheet specs instead of global)
- src/components/AddSpecDialog.test.tsx (updated to check sheet specs instead of global)

### Notes
- All 8 stepsToVerify criteria verified
- Global useSpecificationsStore kept for backwards compat and migration
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (598 tests)
- npm run build passes

## column-types-spec-free - COMPLETED
Support two column types: spec columns (dropdown) and free columns (plain text, no SKU contribution)

### Key decisions
- Updated spreadsheet-adapter.ts to accept columns array and use ColumnDef.type for column behavior
- Spec columns (type='spec'): get dropdownOptions from linked specification via specId
- Free columns (type='free'): render as plain text input, no dropdown, no SKU contribution
- SKU columns (type='sku'): read-only for data rows, auto-generated
- Added column-based functions: generateRowSKUFromColumns, processAutoSKUFromColumns, validateDataSheetFromColumns
- Old header-based functions marked @deprecated but kept for backwards compatibility
- SKU generation uses spec.order for fragment ordering, regardless of column order in sheet

### Files changed
- src/lib/spreadsheet-adapter.ts (signature change: data, columns, specifications)
- src/lib/sheet-sku.ts (added generateRowSKUFromColumns, buildSpecValueMap)
- src/lib/auto-sku.ts (added updateRowSKUFromColumns, findChangedRowsFromColumns, processAutoSKUFromColumns, processAutoSKUForAllRowsFromColumns)
- src/lib/validation.ts (added validateDataSheetFromColumns)
- src/components/SpreadsheetContainer.tsx (uses column-based functions, passes columns to adapter)
- src/lib/spreadsheet-adapter.test.ts (updated tests, added free column tests)
- src/components/SpreadsheetContainer.test.tsx (added createSheetWithColumns helper, updated/fixed 2 tests)

### Notes
- All 6 stepsToVerify criteria implemented and tested
- Free columns have no dropdown options (verified in tests)
- Free column values do not affect SKU (verified in tests)
- Spec order determines SKU fragment order, not column position (verified in tests)
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (572 tests)
- npm run build passes

## sheet-default-rows - COMPLETED
New sheets created with 50 empty rows by default and only SKU column

### Key decisions
- Added createEmptyDataRows() helper to generate empty row arrays
- Modified createEmptySheet() to include 50 empty data rows after header
- Modified addSheetWithId() to use same 50-row structure
- Each empty row has one empty cell ({}) matching column count

### Files changed
- src/store/sheets.ts (added createEmptyDataRows, updated createEmptySheet and addSheetWithId)
- src/store/sheets.test.ts (updated tests for 51 rows, added sheet-default-rows test suite)

### Notes
- All 5 stepsToVerify criteria implemented and tested
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (570 tests)

## sheet-local-specifications - COMPLETED
Make specifications local to each sheet instead of global

### Key decisions
- Added ColumnDef interface to src/types/index.ts with id, type ('sku'|'spec'|'free'), specId?, and header fields
- Updated SheetConfig to include columns: ColumnDef[] and specifications: Specification[] arrays
- New sheets initialize with empty specifications array and a default SKU column
- SpecificationList and SpreadsheetContainer now read from activeSheet.specifications
- Migration logic in sheets store copies global specs to existing sheets on rehydrate

### Files changed
- src/types/index.ts (added ColumnType, ColumnDef interface, updated SheetConfig)
- src/store/sheets.ts (createDefaultColumns, createHeaderRowFromColumns, migration in onRehydrateStorage)
- src/lib/sample-data.ts (added createColumnsFromSpecs function)
- src/components/SpecificationList.tsx (reads from activeSheet.specifications)
- src/components/SpreadsheetContainer.tsx (reads from activeSheet.specifications)
- src/lib/import-export.ts (adds columns/specifications to imported sheets)
- Multiple test files updated to use new SheetConfig structure

### Notes
- All 7 stepsToVerify criteria implemented
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (565 tests)

## migration-import-export - COMPLETED
Verify import/export functionality works with new spreadsheet

### Key decisions
- Integrated existing import-export.ts utilities into SpreadsheetContainer
- Added importFromCSV function to import-export.ts for CSV file support
- Added processAutoSKUForAllRows to auto-sku.ts to regenerate all SKUs after import
- Import handler: detects file type by extension, loads data into active sheet
- Export Excel: exports all sheets via exportToExcel utility
- Export CSV: exports active sheet via exportToCSV utility
- History cleared after import to prevent undo reverting to pre-import state

### Files changed
- src/lib/import-export.ts (added importFromCSV function)
- src/lib/auto-sku.ts (added processAutoSKUForAllRows function)
- src/components/SpreadsheetContainer.tsx (implemented handleImport, handleExportExcel, handleExportCSV)
- src/lib/import-export.test.ts (added 4 tests for importFromCSV)
- src/components/SpreadsheetContainer.test.tsx (added 3 tests for import/export toolbar buttons)

### Notes
- All 5 stepsToVerify criteria implemented
- xlsx library already installed as dependency
- Import triggers SKU regeneration via processAutoSKUForAllRows
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (565 tests total, +7 new)
- npm run build passes

## migration-click-navigate - COMPLETED
Implement click-to-navigate for validation errors

### Key decisions
- Used react-spreadsheet's Selection API: RangeSelection and PointRange classes
- Added selected state to SpreadsheetContainer for controlled selection
- handleErrorClick creates single-cell RangeSelection from error.row/column
- Scroll uses DOM traversal: tbody > tr[row] > td/th[column+1] (accounts for row indicator)
- setTimeout(0) ensures selection state updates before scroll attempt
- onSelect callback passed to Spreadsheet for user selection to still work

### Files changed
- src/components/SpreadsheetContainer.tsx (added selection state, updated handleErrorClick, added props)
- src/components/SpreadsheetContainer.test.tsx (added 5 tests for click-to-navigate, updated mock)

### Notes
- All 4 stepsToVerify criteria verified via unit tests
- Tests verify: clicking error sets selection, works for missing-value errors, works for duplicate-sku errors
- Added scrollIntoView mock for jsdom test environment
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (558 tests total, +5 new)
- npm run build passes

## migration-undo-redo - COMPLETED
Implement undo/redo functionality for spreadsheet edits

### Key decisions
- History stored as CellData[][][] (array of past states)
- historyIndex = -1 means at latest state, >= 0 means in history
- historyIndexRef used to track current position across React render cycles
- When making edit at latest state: push oldData to history, stay at -1
- When making edit after undo: truncate redo states only (current state already in history)
- Undo from latest: append current state for redo, restore history[last], set historyIndex = last
- Undo from history: go to historyIndex - 1
- Redo: go to historyIndex + 1, reset to -1 when reaching end
- isUndoRedoRef prevents recording history for undo/redo-triggered changes
- History clears when switching sheets

### Files changed
- src/components/SpreadsheetContainer.tsx (rewrote undo/redo logic)
- src/components/SpreadsheetContainer.test.tsx (added 7 undo/redo tests)

### Notes
- All 5 stepsToVerify criteria verified via unit tests
- Fixed bug: isUndoRedoRef wasn't being reset in test environment
- Fixed bug: history tracking used closure-captured historyIndex instead of ref
- Tests use act() wrapper to handle React state update timing
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (553 tests total)

## migration-duplicate-highlight - COMPLETED
Verify duplicate SKU warning styling works

### Key decisions
- Duplicate detection via findDuplicateSKUs() in validation.ts (lines 91-137)
- applyDuplicateHighlighting() in SpreadsheetContainer applies className bg-[#fef3c7] for duplicates
- Normal SKU cells get bg-[#f1f5f9] (gray-blue)
- CSS attribute selectors [class*="bg-[#fef3c7]"] in index.css handle dynamic Tailwind classes
- ValidationPanel shows duplicate SKU errors with amber icons

### Files changed
- None (already implemented)

### Notes
- All 4 stepsToVerify criteria verified via existing unit tests
- Tests in SpreadsheetContainer.test.tsx lines 611-702 verify: className applied, all duplicate rows highlighted, unique rows not highlighted, empty SKUs not flagged
- Tests in validation.test.ts lines 208-351 verify findDuplicateSKUs logic
- ValidationPanel integration tested at lines 773-819
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (546 tests total)

## migration-dropdowns - COMPLETED
Verify dropdown selection works in spec columns

### Key decisions
- Dropdown functionality already implemented via DropdownEditor + convertToSpreadsheetData
- DropdownEditor renders <select> when cell.dropdownOptions exists (lines 90-110)
- spreadsheet-adapter.ts populates dropdownOptions from spec.values.displayValue (lines 58-86)
- Tab/Enter/Escape keyboard handling in DropdownEditor calls exitEditMode() (lines 73-85)
- SKU regeneration via processAutoSKU in SpreadsheetContainer.handleDataChange (line 153)

### Files changed
- src/components/SpreadsheetContainer.test.tsx (added 4 tests verifying migration-dropdowns criteria)

### Notes
- All 5 stepsToVerify criteria verified via unit tests
- Tests verify: dropdownOptions populated with displayValues, cell updates on selection, SKU regenerates
- Tab/Enter movement handled by react-spreadsheet internally after exitEditMode
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (546 tests total, +4 new)

## migration-add-row - COMPLETED
Implement Add Row functionality in toolbar

### Key decisions
- handleAddRow already implemented in SpreadsheetContainer (lines 191-197)
- Creates new row with empty cells ({}) matching column count
- convertToSpreadsheetData adds dropdownOptions to empty spec cells (lines 58-63)
- processAutoSKU auto-generates SKU when spec values selected in new row

### Files changed
- src/components/SpreadsheetContainer.test.tsx (added 3 tests for Add Row feature)

### Notes
- All 5 stepsToVerify criteria verified via unit tests
- Tests verify: row count increases, empty cells match column count, dropdownOptions applied, SKU generated
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (542 tests total, +3 new)

## migration-tests-update - COMPLETED
Update SpreadsheetContainer tests for react-spreadsheet

### Key decisions
- Mocked 'react-spreadsheet' instead of '@fortune-sheet/react'
- Test mock captures data and onChange from Spreadsheet component
- Updated tests to verify dropdownOptions, readOnly, className properties
- Dropdown options assigned by column position (col 1 = spec[0]) not header matching
- Sheet tab test IDs use 'sheet-tab-*' pattern from SheetTabs component
- addSheet sets new sheet as active (test logic updated accordingly)

### Files changed
- src/components/SpreadsheetContainer.test.tsx (complete rewrite)

### Notes
- 42 tests pass covering: rendering, dropdowns, onChange, SheetTabs, readOnly, styling, duplicates, validation, SKU auto-generation, toolbar
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- npm run test passes (539 tests total)

## migration-readonly-sku - COMPLETED
Verify SKU column is read-only in react-spreadsheet implementation

### Key decisions
- react-spreadsheet respects `readOnly: true` property on cells
- Library adds `Spreadsheet__cell--readonly` CSS class to readonly cells
- Library prevents click-to-edit on readonly cells via internal check
- CSS updated to target `.Spreadsheet__cell--readonly` instead of old selectors

### Files changed
- src/index.css (fixed CSS selector for readonly cells to use library's class)

### How it works
1. spreadsheet-adapter.ts sets `readOnly: true` on col 0 cells for rows > 0
2. applyDuplicateHighlighting reinforces `readOnly: true` with className for bg color
3. react-spreadsheet adds `Spreadsheet__cell--readonly` class and prevents editing
4. Header row (row 0) has no readOnly flag, allowing column rename
5. processAutoSKU still updates SKU values programmatically when spec values change

### Notes
- All 4 stepsToVerify criteria verified
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- Existing spreadsheet-adapter tests already verify readOnly flag behavior
- SpreadsheetContainer tests fail (expected - need migration-tests-update task)

## migration-css-styles - COMPLETED
Add CSS styles for react-spreadsheet customizations

### Key decisions
- Added .sku-spreadsheet wrapper class to SpreadsheetContainer for scoped styles
- CSS custom properties for theming: --spreadsheet-header-bg, --spreadsheet-readonly-bg, --spreadsheet-duplicate-bg, --spreadsheet-cell-border
- Styles for Tailwind arbitrary values: bg-[#f1f5f9] (readonly), bg-[#fef3c7] (duplicate)
- Header row (tr:first-child .Spreadsheet__cell) styled with font-weight: 600
- Dropdown/select focus styling with outline: 2px solid hsl(var(--ring))
- Dark mode support with appropriate color adjustments
- Toolbar already uses shadcn/ui Button with ghost variant (consistent with app theme)

### Files changed
- src/index.css (added ~100 lines of .sku-spreadsheet styles)
- src/components/SpreadsheetContainer.tsx (added sku-spreadsheet class to wrapper div)

### Notes
- Styles work with Tailwind's arbitrary values approach used in applyDuplicateHighlighting
- Dark mode colors use HSL values matching app theme
- All 6 stepsToVerify criteria verified
- npm run typecheck passes
- npm run lint passes (only pre-existing warnings)
- Tests pass (excluding SpreadsheetContainer which needs migration-tests-update)

## migration-container-rewrite - COMPLETED
Rewrite SpreadsheetContainer to use react-spreadsheet instead of Fortune-Sheet

### Key decisions
- Imports Spreadsheet, Matrix, CellBase from 'react-spreadsheet' (not @fortune-sheet/react)
- Renders <Spreadsheet> with data, onChange, DataEditor props
- SpreadsheetToolbar renders above spreadsheet (undo/redo, import, export, add row)
- SheetTabs renders below spreadsheet (tab switching, rename, delete, add)
- ValidationPanel renders at bottom showing errors for active sheet
- Uses convertToSpreadsheetData/convertFromSpreadsheetData from spreadsheet-adapter
- Undo/redo history tracking with isUndoRedoRef to prevent infinite loops
- Duplicate highlighting via applyDuplicateHighlighting function
- Deep comparison via isDataEqual to detect actual cell changes

### Files changed
- src/components/SpreadsheetContainer.tsx (already rewritten in migration-dependencies)

### Notes
- All 6 stepsToVerify criteria verified manually
- npm run typecheck passes
- npm run lint passes (only warnings)
- Tests still mock @fortune-sheet/react (migration-tests-update task)
- Import/export handlers are placeholder implementations (migration-import-export task)
- Click-to-navigate for errors is placeholder (migration-click-navigate task)

## migration-dependencies - COMPLETED
Swap spreadsheet library dependencies - remove Fortune-Sheet, add react-spreadsheet

### Key decisions
- Removed @fortune-sheet/react from dependencies
- Added react-spreadsheet ^0.9.5 and scheduler ^0.23.2
- Rewrote SpreadsheetContainer to use react-spreadsheet imports
- Integrated SheetTabs, SpreadsheetToolbar, DropdownEditor components
- Added basic undo/redo history tracking in SpreadsheetContainer
- Import/export/click-to-navigate are placeholder implementations

### Files changed
- package.json (dependencies swapped)
- src/components/SpreadsheetContainer.tsx (rewritten for react-spreadsheet)

### Notes
- SpreadsheetContainer.test.tsx still mocks @fortune-sheet/react (migration-tests-update task)
- Build passes, 42 tests fail (expected - tests need update)
- Local CellBase type in types/spreadsheet.ts can now be removed since react-spreadsheet is installed
- Full implementation details deferred to migration-container-rewrite task

## migration-toolbar - COMPLETED
SpreadsheetToolbar component with basic actions for spreadsheet manipulation

### Key decisions
- Props: canUndo, canRedo, onUndo, onRedo, onImport, onExportExcel, onExportCSV, onAddRow
- Undo/Redo buttons with disabled state based on canUndo/canRedo props
- Import button triggers hidden file input accepting .xlsx, .xls, .csv
- Export uses Radix UI DropdownMenu with Excel (.xlsx) and CSV (.csv) options
- Add Row button calls onAddRow callback
- Uses shadcn/ui Button component with ghost variant for toolbar styling
- Lucide icons: Undo2, Redo2, Upload, Download, Plus, ChevronDown
- data-testid attributes for testing

### Files changed
- src/components/spreadsheet/SpreadsheetToolbar.tsx (new)
- src/components/spreadsheet/SpreadsheetToolbar.test.tsx (new, 26 tests)

### Notes
- Standalone component ready for SpreadsheetContainer integration
- Actual undo/redo/add-row behavior to be implemented via parent callbacks
- Tests cover: button states, callbacks, file input, dropdown behavior
- Radix dropdown portal not tested directly (vitest limitation), tested via attributes

## migration-sheet-tabs - COMPLETED
Custom SheetTabs component for multi-sheet navigation

### Key decisions
- Props: sheets, activeSheetId, onActivate, onRename, onDelete, onAdd
- Tab switching via single click calls onActivate(id)
- Inline rename on double-click, commits on Enter/blur, cancels on Escape
- Delete confirmation requires two clicks, auto-resets after 3 seconds
- Delete button hidden when only one sheet exists (can't delete last sheet)
- Active tab has distinct styling: bg-background with border, inactive uses bg-muted/50
- Uses data-testid attributes for testing
- Uses Tailwind CSS, lucide-react icons (Plus, X), and cn utility

### Files changed
- src/components/spreadsheet/SheetTabs.tsx (new)
- src/components/spreadsheet/SheetTabs.test.tsx (new, 23 tests)

### Notes
- Standalone component ready to integrate with SpreadsheetContainer
- Tests cover: rendering, tab switching, renaming, deletion, adding, edge cases
- Uses fireEvent instead of userEvent to avoid fake timer issues

## migration-dropdown-editor - COMPLETED
Custom DataEditor component for dropdown selection in spec columns

### Key decisions
- Implemented DropdownEditorProps interface matching react-spreadsheet's DataEditorProps
- Props: cell (SKUCell), onChange, exitEditMode, row, column
- Renders <select> when cell.dropdownOptions exists and has values
- Renders <input type="text"> as fallback when no dropdown options
- Keyboard: Enter/Tab/Escape all call exitEditMode() for consistent UX
- Auto-focus on mount for both select and input elements
- Empty "Select..." placeholder option in dropdown for clearing selection
- Uses data-testid attributes for testing

### Files changed
- src/components/spreadsheet/DropdownEditor.tsx (new)
- src/components/spreadsheet/DropdownEditor.test.tsx (new, 21 tests)

### Notes
- Created new src/components/spreadsheet directory for migration components
- Component is standalone, ready to integrate with react-spreadsheet once dependencies installed
- Tests cover: dropdown vs input rendering, onChange callbacks, keyboard events, auto-focus, edge cases

## migration-spreadsheet-adapter - COMPLETED
Create data conversion utilities for react-spreadsheet (convertToSpreadsheetData, convertFromSpreadsheetData)

### Key decisions
- convertToSpreadsheetData transforms CellData[][] to SKUMatrix
- Row 0 (header) cells have no readOnly or dropdownOptions
- Col 0 (SKU) cells for row > 0 get readOnly: true
- Spec columns (col 1+) for row > 0 get dropdownOptions from sorted specifications
- Specifications sorted by order field to match column positions
- Background colors converted to Tailwind-style className (bg-[#hex])
- convertFromSpreadsheetData transforms back, extracting bg from className

### Files changed
- src/lib/spreadsheet-adapter.ts (new)
- src/lib/spreadsheet-adapter.test.ts (new, 15 tests)

### Notes
- Uses SKUCell/SKUMatrix types from migration-spreadsheet-types task
- Handles empty cells, null values, numeric values
- Roundtrip conversion preserves values

## migration-spreadsheet-types - COMPLETED
Create extended cell type for react-spreadsheet (SKUCell interface, SKUMatrix type)

### Key decisions
- Defined CellBase type locally to avoid dependency on uninstalled react-spreadsheet package
- CellBase matches react-spreadsheet's interface: value, readOnly, className
- SKUCell extends CellBase<string | number | null> with dropdownOptions field
- SKUMatrix is (SKUCell | null)[][] to support nullable cells

### Files changed
- src/types/spreadsheet.ts (new)

### Notes
- react-spreadsheet not yet installed (handled by migration-dependencies task)
- CellBase is duplicated locally - will need update once react-spreadsheet installed
