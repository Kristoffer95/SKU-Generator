[
  {
    "id": "migration-spreadsheet-types",
    "category": "Spreadsheet Migration",
    "description": "Create extended cell type for react-spreadsheet. Define SKUCell interface extending CellBase with value, readOnly, className, and dropdownOptions fields. Create SKUMatrix type alias for 2D array of SKUCell.",
    "stepsToVerify": [
      "src/types/spreadsheet.ts exists with SKUCell interface",
      "SKUCell has: value (string|number|null), readOnly (boolean), className (string), dropdownOptions (string[])",
      "SKUMatrix type is exported as (SKUCell | null)[][]",
      "npm run typecheck passes"
    ],
    "passes": true
  },
  {
    "id": "migration-spreadsheet-adapter",
    "category": "Spreadsheet Migration",
    "description": "Create data conversion utilities for react-spreadsheet. Implement convertToSpreadsheetData() to transform CellData[][] to SKUMatrix with readOnly flags on SKU column and dropdownOptions on spec columns. Implement convertFromSpreadsheetData() to transform back.",
    "stepsToVerify": [
      "src/lib/spreadsheet-adapter.ts exports convertToSpreadsheetData and convertFromSpreadsheetData",
      "convertToSpreadsheetData sets readOnly: true on col 0 cells (except row 0 header)",
      "convertToSpreadsheetData populates dropdownOptions from specifications for spec columns",
      "convertFromSpreadsheetData converts SKUMatrix back to CellData[][]",
      "npm run typecheck passes"
    ],
    "passes": true
  },
  {
    "id": "migration-dropdown-editor",
    "category": "Spreadsheet Migration",
    "description": "Create custom DataEditor component for dropdown selection in spec columns. When cell has dropdownOptions, render <select> with options. When no dropdownOptions, render text input. Handle keyboard events (Enter, Tab, Escape) for UX.",
    "stepsToVerify": [
      "src/components/spreadsheet/DropdownEditor.tsx exports DropdownEditor component",
      "Component renders <select> when cell.dropdownOptions exists and has values",
      "Component renders <input type='text'> as fallback when no dropdown options",
      "Keyboard: Enter/Tab commits and exits edit, Escape cancels",
      "Select auto-focuses on mount"
    ],
    "passes": true
  },
  {
    "id": "migration-sheet-tabs",
    "category": "Spreadsheet Migration",
    "description": "Create custom SheetTabs component for multi-sheet navigation. Support tab switching (click), tab renaming (double-click), tab deletion (X button with confirmation), and add new sheet (+ button). Style active tab distinctly.",
    "stepsToVerify": [
      "src/components/spreadsheet/SheetTabs.tsx exports SheetTabs component",
      "Click on tab calls onActivate with sheet id",
      "Double-click enables inline rename input",
      "Rename commits on Enter/blur, cancels on Escape",
      "X button calls onDelete (visible only when multiple sheets exist)",
      "+ button calls onAdd",
      "Active tab has distinct styling (border/background)"
    ],
    "passes": true
  },
  {
    "id": "migration-toolbar",
    "category": "Spreadsheet Migration",
    "description": "Create SpreadsheetToolbar component with basic actions. Include Undo/Redo buttons, Import button (opens file picker for Excel/CSV), Export dropdown (Excel/CSV options), and Add Row button.",
    "stepsToVerify": [
      "src/components/spreadsheet/SpreadsheetToolbar.tsx exports SpreadsheetToolbar component",
      "Undo button reverts last change (or is disabled when nothing to undo)",
      "Redo button re-applies undone change (or is disabled when nothing to redo)",
      "Import button triggers file input for .xlsx/.csv files",
      "Export offers Excel and CSV download options",
      "Add Row button appends new empty row to active sheet"
    ],
    "passes": true
  },
  {
    "id": "migration-dependencies",
    "category": "Spreadsheet Migration",
    "description": "Swap spreadsheet library dependencies. Remove @fortune-sheet/react, add react-spreadsheet and scheduler peer dependency.",
    "stepsToVerify": [
      "package.json does not contain @fortune-sheet/react",
      "package.json contains react-spreadsheet",
      "package.json contains scheduler as dependency",
      "npm install completes without errors",
      "npm run build completes without errors"
    ],
    "passes": true
  },
  {
    "id": "migration-container-rewrite",
    "category": "Spreadsheet Migration",
    "description": "Rewrite SpreadsheetContainer to use react-spreadsheet instead of Fortune-Sheet. Integrate custom DropdownEditor, SheetTabs, and SpreadsheetToolbar. Remove Fortune-Sheet imports, hooks, and data conversion. Use new spreadsheet-adapter functions for data transformation.",
    "stepsToVerify": [
      "SpreadsheetContainer imports from 'react-spreadsheet' not '@fortune-sheet/react'",
      "Component renders <Spreadsheet> with data, onChange, DataEditor props",
      "SheetTabs component renders below spreadsheet",
      "SpreadsheetToolbar component renders above spreadsheet",
      "ValidationPanel still renders and functions correctly",
      "npm run typecheck passes"
    ],
    "passes": true
  },
  {
    "id": "migration-readonly-sku",
    "category": "Spreadsheet Migration",
    "description": "Verify SKU column (column A) is read-only in the new react-spreadsheet implementation. Users cannot edit SKU cells except the header. Apply visual styling to indicate read-only status.",
    "stepsToVerify": [
      "Click on SKU cell (row > 0) does not enable editing",
      "SKU column has distinct background color (#f1f5f9 gray-blue)",
      "Header cell (row 0, col 0) IS editable for renaming column",
      "Auto-generated SKU values still update when spec values change"
    ],
    "passes": true
  },
  {
    "id": "migration-dropdowns",
    "category": "Spreadsheet Migration",
    "description": "Verify dropdown selection works in spec columns. When clicking/editing a spec column cell, dropdown appears with specification values. Selecting a value updates the cell and triggers SKU regeneration.",
    "stepsToVerify": [
      "Click/Enter on spec column cell shows dropdown with spec values",
      "Dropdown options match displayValues from specification store",
      "Selecting a value updates cell content",
      "SKU in column A regenerates with new skuFragment",
      "Tab/Enter moves to next cell after selection"
    ],
    "passes": true
  },
  {
    "id": "migration-duplicate-highlight",
    "category": "Spreadsheet Migration",
    "description": "Verify duplicate SKU warning styling works. Rows with duplicate SKU values should have amber background highlighting on the SKU cell.",
    "stepsToVerify": [
      "Create two rows with same spec value combination",
      "Both SKU cells show amber background (#fef3c7)",
      "Changing one row to have different values removes amber from both",
      "Validation panel shows duplicate SKU errors"
    ],
    "passes": true
  },
  {
    "id": "migration-click-navigate",
    "category": "Spreadsheet Migration",
    "description": "Implement click-to-navigate for validation errors. When clicking an error in ValidationPanel, scroll to and select the affected cell in the spreadsheet.",
    "stepsToVerify": [
      "Click on validation error in panel",
      "Spreadsheet scrolls to show the affected cell",
      "Affected cell is selected/highlighted",
      "Works for both missing-value and duplicate-sku error types"
    ],
    "passes": true
  },
  {
    "id": "migration-css-styles",
    "category": "Spreadsheet Migration",
    "description": "Add CSS styles for react-spreadsheet customizations. Style read-only cells, duplicate warning cells, header row, dropdown editor, and toolbar.",
    "stepsToVerify": [
      "src/index.css (or dedicated file) has .sku-spreadsheet styles",
      "Read-only cells have gray-blue background",
      "Duplicate SKU cells have amber background",
      "Header row (first row) has bold text and light background",
      "Dropdown/select has proper focus outline styling",
      "Toolbar buttons have consistent styling with app theme"
    ],
    "passes": true
  },
  {
    "id": "migration-tests-update",
    "category": "Spreadsheet Migration",
    "description": "Update SpreadsheetContainer tests for react-spreadsheet. Mock react-spreadsheet instead of @fortune-sheet/react. Update test assertions for new component structure.",
    "stepsToVerify": [
      "SpreadsheetContainer.test.tsx mocks 'react-spreadsheet' not '@fortune-sheet/react'",
      "Tests verify data transformation works correctly",
      "Tests verify sheet tab interactions",
      "npm run test passes for SpreadsheetContainer tests"
    ],
    "passes": true
  },
  {
    "id": "migration-undo-redo",
    "category": "Spreadsheet Migration",
    "description": "Implement undo/redo functionality for spreadsheet edits. Track change history and allow reverting/reapplying changes via toolbar buttons.",
    "stepsToVerify": [
      "Edit a cell value, click Undo - value reverts to previous",
      "After Undo, click Redo - value returns to edited state",
      "Undo button disabled when no history",
      "Redo button disabled when at latest state",
      "History clears when switching sheets"
    ],
    "passes": true
  },
  {
    "id": "migration-import-export",
    "category": "Spreadsheet Migration",
    "description": "Verify import/export functionality works with new spreadsheet. Toolbar import loads Excel/CSV files, export downloads current sheet data.",
    "stepsToVerify": [
      "Click Import, select .xlsx file - data loads into active sheet",
      "Click Import, select .csv file - data loads into active sheet",
      "Click Export > Excel - downloads .xlsx file with current data",
      "Click Export > CSV - downloads .csv file with current data",
      "Imported data triggers SKU regeneration"
    ],
    "passes": true
  },
  {
    "id": "migration-add-row",
    "category": "Spreadsheet Migration",
    "description": "Implement Add Row functionality in toolbar. Button appends new empty row to active sheet with proper cell structure for spec columns.",
    "stepsToVerify": [
      "Click Add Row button in toolbar",
      "New row appears at bottom of sheet",
      "New row has empty SKU cell and empty spec cells",
      "Spec cells in new row have dropdown functionality",
      "Selecting values in new row generates SKU"
    ],
    "passes": true
  }
]
