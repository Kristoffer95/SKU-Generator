{
  "project": "SKU Generator",
  "description": "A React application using a Config sheet as single source of truth for specification definitions, with auto-generation of SKU codes in a spreadsheet interface",
  "items": [
    {
      "id": "PRD-001",
      "category": "Project Setup",
      "description": "Initialize React project with Vite, TypeScript, Tailwind CSS, shadcn/ui, Framer Motion, Zustand, and Fortune-Sheet",
      "stepsToVerify": [
        "Run 'npm create vite@latest' with react-ts template",
        "Install all dependencies: zustand, framer-motion, @fortune-sheet/react, tailwindcss",
        "Configure Tailwind CSS with tailwind.config.js and postcss.config.js",
        "Initialize shadcn/ui and add required components (button, card, dialog, sidebar, tabs, input)",
        "Verify 'npm run dev' starts the development server without errors"
      ],
      "passes": true
    },
    {
      "id": "PRD-002",
      "category": "Data Model",
      "description": "Define TypeScript interfaces for Config sheet-based specification management",
      "stepsToVerify": [
        "Create src/types/index.ts with ConfigRow interface (specification, value, skuCode)",
        "Create ParsedSpec interface (name, values array with label and skuCode)",
        "Create SheetConfig interface for multi-sheet support including Config sheet",
        "Create AppSettings interface for SKU delimiter and prefix/suffix options",
        "Create CellData interface matching Fortune-Sheet cell format",
        "Verify TypeScript compiles without errors"
      ],
      "passes": true
    },
    {
      "id": "PRD-003",
      "category": "State Management",
      "description": "Implement Zustand stores for sheets and settings with Config sheet as spec source of truth",
      "stepsToVerify": [
        "Create src/store/sheets.ts for multi-sheet management with Config sheet always first",
        "Initialize sheets store with default Config sheet containing headers (Specification, Value, SKU Code)",
        "Create src/store/settings.ts for app configuration (delimiter, prefix, suffix)",
        "Remove or deprecate src/store/specifications.ts (specs now live in Config sheet)",
        "Verify stores persist to localStorage on changes",
        "Verify Config sheet cannot be deleted"
      ],
      "passes": true
    },
    {
      "id": "PRD-004",
      "category": "SKU Generation Logic",
      "description": "Implement SKU generation that looks up codes from Config sheet data",
      "stepsToVerify": [
        "Create src/lib/config-sheet.ts with parseConfigSheet function to extract specs from Config data",
        "Create getSpecValues function to get all values for a specification name",
        "Create src/lib/sheet-sku.ts with generateRowSKU function",
        "Function takes row values, column headers, parsed config, and settings",
        "Function looks up skuCode from Config for each cell value",
        "Function joins codes with configurable delimiter and adds prefix/suffix",
        "Test: Row with 'Red', 'Small' lookups from Config -> 'R-S'"
      ],
      "passes": true
    },
    {
      "id": "PRD-005",
      "category": "Sidebar Specification View",
      "description": "Create sidebar UI that displays specifications parsed from Config sheet",
      "stepsToVerify": [
        "Update SpecificationList to parse and display specs from Config sheet data",
        "Show each specification name with count of defined values",
        "Add 'Add Specification' button that opens AddSpecDialog",
        "Clicking a specification jumps to or highlights it in Config sheet",
        "Remove direct editing in sidebar (specs are edited in Config sheet)",
        "Sidebar updates automatically when Config sheet changes"
      ],
      "passes": true
    },
    {
      "id": "PRD-006",
      "category": "Spreadsheet Integration",
      "description": "Integrate Fortune-Sheet with dropdowns populated from Config sheet",
      "stepsToVerify": [
        "Create SpreadsheetContainer component wrapping Fortune-Sheet Workbook",
        "Parse Config sheet to get all spec names and their allowed values",
        "For data sheets: column headers define which spec applies to that column",
        "Generate dataVerification (dropdown) for cells based on column header matching Config spec",
        "Verify clicking a cell in data sheet shows dropdown with values from Config",
        "Last column is reserved for auto-generated SKU"
      ],
      "passes": true
    },
    {
      "id": "PRD-007",
      "category": "Auto SKU Generation",
      "description": "Automatically update SKU column when values are selected in data sheet rows",
      "stepsToVerify": [
        "Listen to onChange callback from Fortune-Sheet",
        "When a cell value changes in a data sheet, identify the row",
        "Collect all values in that row and their column headers",
        "Look up SKU codes from Config sheet for each value",
        "Generate SKU and update the SKU column cell",
        "Test: Select 'Red' (R), 'Small' (S) in row -> SKU shows 'R-S'"
      ],
      "passes": true
    },
    {
      "id": "PRD-008",
      "category": "Multiple Sheets",
      "description": "Support Config sheet plus multiple data sheets with independent data",
      "stepsToVerify": [
        "Create SheetTabs component showing tab bar at bottom of spreadsheet",
        "Config sheet is always the first tab and cannot be deleted or renamed",
        "Style Config tab distinctly (different color or icon)",
        "Support adding new data sheets via '+' button",
        "Support renaming data sheets (double-click tab)",
        "Support deleting data sheets (X button on tab, not Config)",
        "Each data sheet maintains independent row data but shares Config specs"
      ],
      "passes": true
    },
    {
      "id": "PRD-009",
      "category": "App Layout",
      "description": "Create main application layout with header actions for import/export/settings",
      "stepsToVerify": [
        "Create AppLayout component with shadcn/ui SidebarProvider",
        "Left sidebar contains specification view (read from Config)",
        "Main area contains spreadsheet with sheet tabs below",
        "Header with app title, sidebar toggle, Import button, Export dropdown, Settings button",
        "Sidebar should be collapsible/expandable"
      ],
      "passes": true
    },
    {
      "id": "PRD-010",
      "category": "Import/Export",
      "description": "Support importing and exporting spreadsheet data including Config sheet",
      "stepsToVerify": [
        "Create src/lib/import-export.ts with exportToExcel function",
        "Export includes all sheets (Config + data sheets) in one workbook",
        "Create exportToCSV function for current sheet only",
        "Create importFromExcel function that loads all sheets including Config",
        "Importing a workbook with Config sheet replaces current specs",
        "Verify exported Excel opens correctly in Excel/Google Sheets",
        "Verify importing an Excel file loads Config and data correctly"
      ],
      "passes": true
    },
    {
      "id": "PRD-011",
      "category": "Settings",
      "description": "Allow users to configure SKU generation settings (delimiter, prefix, suffix)",
      "stepsToVerify": [
        "Create SettingsDialog component accessible from header",
        "Setting: SKU delimiter (default '-', options: '-', '_', '', custom)",
        "Setting: SKU prefix (optional string prepended to all SKUs)",
        "Setting: SKU suffix (optional string appended to all SKUs)",
        "Settings persist to localStorage via Zustand",
        "Changing settings triggers SKU recalculation for all rows in all data sheets"
      ],
      "passes": true
    },
    {
      "id": "PRD-012",
      "category": "End-to-End Verification",
      "description": "Complete workflow test using Config sheet for spec definitions",
      "stepsToVerify": [
        "In Config sheet, add rows: Temperature/29deg C/29C, Temperature/30deg C/30C",
        "In Config sheet, add rows: Color/Red/R, Color/Blue/B",
        "In Config sheet, add rows: Type/Standard/STD, Type/Premium/PRM",
        "Create new data sheet, add columns: Temperature, Color, Type, SKU",
        "Verify dropdowns in Temperature column show '29deg C', '30deg C'",
        "Select '29deg C', 'Red', 'Standard' in row 2",
        "Verify SKU column auto-generates '29C-R-STD'",
        "Change Color to 'Blue' -> SKU updates to '29C-B-STD'",
        "Export to Excel and verify Config sheet and data are included"
      ],
      "passes": true
    },
    {
      "id": "PRD-013",
      "category": "Add Specification Dialog",
      "description": "Dialog for adding new specifications to Config sheet and data sheet columns",
      "stepsToVerify": [
        "Create AddSpecDialog component accessible from sidebar",
        "Form fields: specification name, initial values (label + SKU code pairs)",
        "On submit: add rows to Config sheet for each value",
        "On submit: add column with spec name as header to active data sheet",
        "Validate specification name is unique (not already in Config)",
        "Verify new dropdown appears in the new column with defined values"
      ],
      "passes": true
    },
    {
      "id": "PRD-014",
      "category": "Bug Fix",
      "description": "Fix infinite re-render loop in SpreadsheetContainer causing app crash with 'Maximum update depth exceeded' error",
      "stepsToVerify": [
        "Add useRef and useEffect to imports in SpreadsheetContainer.tsx",
        "Create isDataEqual helper function for deep comparison of CellData[][] arrays",
        "Replace sheetsRef useMemo with useRef (previousDataRef) to track previous data without triggering re-renders",
        "Add sheetsSnapshotRef useRef synced via useEffect to access current sheets without dependency",
        "Memoize configSheet with useMemo instead of calling getConfigSheet() directly",
        "Rewrite handleChange callback: remove sheets/sheetsRef from dependencies, add isDataEqual check to skip unchanged data",
        "Update handleBeforeDeleteSheet and handleBeforeUpdateSheetName to use sheetsSnapshotRef instead of sheets dependency",
        "Verify app loads without blank white page",
        "Verify browser console has no 'Maximum update depth exceeded' errors",
        "Verify editing cells in data sheet auto-generates SKU correctly",
        "Verify switching between sheets works without crashes",
        "Run npm run typecheck with no errors",
        "Run npm run lint with no errors",
        "Run npm run test with all tests passing"
      ],
      "passes": true
    },
    {
      "id": "PRD-015",
      "category": "Feature Enhancement",
      "description": "Move SKU column from last column to Column A (index 0) in data sheets for improved visibility and workflow",
      "stepsToVerify": [
        "Update src/lib/sheet-sku.ts extractColumnHeaders() to skip first column (index 0) instead of last column",
        "Update src/lib/sheet-sku.ts getRowValuesWithoutSKU() to use row.slice(1) instead of row.slice(0, -1)",
        "Update src/lib/auto-sku.ts updateRowSKU() to write SKU to row[0] instead of row[headers.length]",
        "Update src/lib/auto-sku.ts findChangedRows() to compare columns starting from index 1 (skip SKU column)",
        "Update src/components/SpreadsheetContainer.tsx extractHeaders() to skip first column instead of last",
        "Update src/components/SpreadsheetContainer.tsx buildDataVerification() to apply dropdowns to columns 1+ (colIndex = headerIndex + 1)",
        "Update test file src/lib/sheet-sku.test.ts with new column order (SKU first)",
        "Update test file src/lib/auto-sku.test.ts with new column order (SKU first)",
        "Update test file src/lib/e2e-workflow.test.ts with new column order (SKU first)",
        "Verify npm run typecheck passes with no errors",
        "Verify npm run lint passes with no errors",
        "Verify npm run test passes with all tests passing",
        "Manual test: Create new data sheet, verify Column A header is 'SKU'",
        "Manual test: Add spec columns (Color, Size) starting from Column B",
        "Manual test: Select values from dropdowns in spec columns",
        "Manual test: Verify SKU auto-generates in Column A when values are selected"
      ],
      "passes": true
    },
    {
      "id": "PRD-016",
      "category": "User Onboarding",
      "description": "Implement comprehensive 24-step Driver.js guided tutorial organized into 3 phases (Foundation, Create SKU, Advanced) that teaches users how to use the app step-by-step with auto-opening dialogs at relevant steps",
      "stepsToVerify": [
        "Auto-start tour on first page load: In App.tsx useEffect, check hasTourCompleted() and call startGuidedTour() if false",
        "Add small delay (500-1000ms) before auto-starting tour to ensure all elements are rendered",
        "Phase 1 - Foundation (Steps 1-7): Welcome, Config tab intro, Config structure explanation, row mapping demo, sidebar overview, spec cards explanation, foundation checkpoint",
        "Phase 2 - Create SKU (Steps 8-17): Add spec button, add spec dialog overview, spec name field, values section, create data sheet, column headers setup, SKU column explanation, dropdown usage, SKU generation explanation, create SKU checkpoint",
        "Phase 3 - Advanced (Steps 18-24): Settings button, settings dialog, import button, export button, multi-sheet overview, tour restart button, completion",
        "Rewrite src/lib/guided-tour.ts with 24 detailed tutorial steps replacing existing 10 generic steps",
        "Add dialog opener registry: registerTourDialogOpeners() function to coordinate auto-opening dialogs during tour",
        "Implement onHighlightStarted hook to auto-open AddSpecDialog at steps 8-11 and SettingsDialog at step 18-19",
        "Implement onDeselected hook to close dialogs when leaving dialog steps",
        "Add data-tour='add-spec-dialog' attribute to DialogContent in src/components/AddSpecDialog.tsx",
        "Add data-tour='spec-name-input' attribute to spec name Input in src/components/AddSpecDialog.tsx",
        "Add data-tour='spec-values-section' attribute to values container div in src/components/AddSpecDialog.tsx",
        "Add data-tour='settings-dialog' attribute to DialogContent in src/components/SettingsDialog.tsx",
        "Add data-tour='spec-item' attribute to first SpecItem card in src/components/SpecificationList.tsx",
        "Register addSpec dialog opener in SpecificationList.tsx via useEffect calling registerTourDialogOpeners()",
        "Register settings dialog opener in AppLayout.tsx via useEffect calling registerTourDialogOpeners()",
        "Register closeAll callback to close all dialogs when tour ends or leaves dialog steps",
        "Each step must have descriptive title and detailed description explaining WHAT to do and WHY",
        "Verify tour starts when clicking Tour button in header",
        "Verify all 24 steps highlight correct elements",
        "Verify AddSpecDialog auto-opens at steps 8-11",
        "Verify SettingsDialog auto-opens at steps 18-19",
        "Verify dialogs close when navigating away from dialog steps",
        "Verify Previous/Next navigation works correctly through all 24 steps",
        "Verify tour can be dismissed at any point",
        "Verify tour completion state persists to localStorage",
        "Verify tour auto-starts on first page load (clear localStorage, refresh page)",
        "Verify tour does NOT auto-start on subsequent visits (after completion)",
        "Run npm run typecheck with no errors",
        "Run npm run lint with no errors",
        "Run npm run test with all tests passing"
      ],
      "passes": true
    },
    {
      "id": "PRD-017",
      "category": "Documentation",
      "description": "Create comprehensive GUIDE.md documentation covering all app features, workflows, and best practices for SKU generation",
      "stepsToVerify": [
        "Create GUIDE.md in project root",
        "Section: Getting Started - app overview and initial setup",
        "Section: Config Sheet - how to define specifications with value-to-SKU mappings",
        "Section: Adding Specifications - step-by-step for adding new specs",
        "Section: Data Sheets - creating and managing multiple data sheets",
        "Section: Column Headers - how headers link to Config specs for dropdowns",
        "Section: Dropdowns - how to use dropdowns to select values",
        "Section: SKU Generation - how SKU is auto-generated in Column A",
        "Section: Settings - configuring delimiter, prefix, and suffix",
        "Section: Import/Export - exporting to Excel/CSV and importing data",
        "Section: Multi-Sheet Workflow - working with multiple data sheets",
        "Section: Tips and Best Practices - common patterns and recommendations",
        "Section: Troubleshooting - common issues and solutions",
        "Include screenshots or diagrams for key workflows (optional)",
        "Verify GUIDE.md renders correctly in GitHub markdown preview",
        "Link GUIDE.md from README.md for easy discoverability"
      ],
      "passes": true
    },
    {
      "id": "PRD-018",
      "category": "Bug Fix",
      "description": "Fix bug where specifications disappear when editing any cell - Config sheet is being overwritten by Fortune-Sheet onChange handler",
      "stepsToVerify": [
        "In src/components/SpreadsheetContainer.tsx handleChange callback, add early return for Config sheets",
        "Add check: if (sheetConfig?.type === 'config') { return } before setSheetData call",
        "This ensures Config sheet data is only modified through explicit spec operations (AddSpecDialog), not Fortune-Sheet onChange",
        "Verify: Add specifications to Config sheet via AddSpecDialog",
        "Verify: Edit a cell in a data sheet",
        "Verify: Specifications remain intact in Config sheet after editing",
        "Verify: Specifications remain intact after switching between sheets",
        "Verify: SKU auto-generation still works correctly for data sheets",
        "Run npm run typecheck with no errors",
        "Run npm run lint with no errors",
        "Run npm run test with all tests passing"
      ],
      "passes": true
    }
  ]
}
